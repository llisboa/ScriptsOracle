/* **********************************************************************************
   INTERCRAFT SOLUTIONS INFORMÁTICA LTDA - 2008
   SCRIPT CRIADO EM 22/09/2011 02:42

   IMPORTANTE!!!
   * O SISTEMA LOGARÁ SYSTEM PARA INICIAR A EXECUÇÃO, LOGO, MUITO CUIDADO!
   * CASO O USUÁRIO DO ESQUEMA JÁ EXISTA, ESTE SERÁ ELIMINADO, PORTANTO, TENHA A CERTEZA DAQUILO QUE ESTÁ FAZENDO.
   * ARQUIVO C:\ATLAS.LOG REGISTRARÁ O LOG DE EXECUÇÃO, QUE DEVE SER VERIFICADO.
   * CASO BANCO POSSUA ACENTOS, PRECISARÁ GARANTIR FORMATO ANSI ANTES DA EXECUÇÃO. PARA ISSO, EDITE O CONTEÚDO NO NOTEPAD E SALVE FAZENDO OPÇÃO POR ESTE FORMATO.
*/

SET ECHO ON
SET HEADING OFF
SET PAGESIZE 0
SET LINES 10000
SET LINESIZE 10000
SET SERVEROUTPUT ON SIZE 40000
SPOOL C:\ATLAS_PARTE1.LOG

-- GARANTINDO QUE TODOS TENHA ACESSO AOS RECURSOS DE PACOTE
CONNECT SYS/XXXX@SBDB AS SYSDBA
GRANT EXECUTE ON SYS.UTL_FILE TO PUBLIC;
GRANT EXECUTE ON SYS.UTL_SMTP TO PUBLIC;
GRANT EXECUTE ON SYS.UTL_TCP TO PUBLIC;
GRANT SELECT ON SYS.V_$SESSION TO PUBLIC;
GRANT QUERY REWRITE TO PUBLIC;
GRANT CREATE MATERIALIZED VIEW TO PUBLIC;
ALTER SESSION SET QUERY_REWRITE_ENABLED = TRUE;

-- ELIMINA OS JOBS
begin
for cur in (select job from user_jobs where schema_user='ATLAS') loop
dbms_job.remove(cur.job);
end loop;
end;
/

-- INICIALIZANDO TABLESPACE
ALTER TABLESPACE T_ATLAS_DAT OFFLINE;
DROP TABLESPACE T_ATLAS_DAT INCLUDING CONTENTS;
CREATE TABLESPACE T_ATLAS_DAT DATAFILE 'C:\oracle\product\10.2.0\oradata\SBDB\ATLAS.DBF' SIZE 100M REUSE
AUTOEXTEND ON NEXT 50M MAXSIZE UNLIMITED EXTENT MANAGEMENT LOCAL;

-- DEFININDO USUÁRIO DE ESQUEMA
DROP USER ATLAS CASCADE;
CREATE USER ATLAS IDENTIFIED BY XXXXXX DEFAULT TABLESPACE T_ATLAS_DAT;
GRANT DBA TO ATLAS;
GRANT SELECT ON DBA_JOBS TO ATLAS;
GRANT ALL PRIVILEGES TO ATLAS;

-- CONECTANDO COM USUÁRIO DE ESQUEMA
DISCONNECT;
CONNECT ATLAS/XXXX@SBDB;

/* **********************************************************************************
   CRIAÇÃO DE TABELAS
*/

-- TABELA AUTOR
CREATE TABLE ATLAS."AUTOR" (
   "CODIGO" NUMBER (10,0),
   "NOME" VARCHAR2 (200)
,
   SYS_MOMENTO_CRIA DATE,
   SYS_USUARIO_CRIA VARCHAR2 (100),
   SYS_LOCAL_CRIA VARCHAR2 (100),
   SYS_MOMENTO_ATUALIZA DATE,
   SYS_USUARIO_ATUALIZA VARCHAR2 (100),
   SYS_LOCAL_ATUALIZA VARCHAR2 (100),
   SYS_STATUS CHAR (1)
);

ALTER TABLE ATLAS."AUTOR" ADD CONSTRAINT "ID_AUTOR"
PRIMARY KEY("CODIGO");

COMMENT ON TABLE ATLAS."AUTOR" IS 'ATLAS | Autor pesquisador remetente de fotos. | Autor';

COMMENT ON COLUMN ATLAS."AUTOR"."CODIGO" IS 'Sequencial do autor. | Sequencial';
COMMENT ON COLUMN ATLAS."AUTOR"."NOME" IS 'Nome. | Nome';
COMMENT ON COLUMN ATLAS."AUTOR".SYS_MOMENTO_CRIA IS 'Registra momento de gravação. | Momento de Criação';
COMMENT ON COLUMN ATLAS."AUTOR".SYS_USUARIO_CRIA IS 'Registra usuário que gravou. | Usuário que Criou';
COMMENT ON COLUMN ATLAS."AUTOR".SYS_LOCAL_CRIA IS 'Registra local de gravação. | Local de Criação';
COMMENT ON COLUMN ATLAS."AUTOR".SYS_MOMENTO_ATUALIZA IS 'Registra momento de atualização. | Momento de Atualização';
COMMENT ON COLUMN ATLAS."AUTOR".SYS_USUARIO_ATUALIZA IS 'Registra usuário que atualizou. | Usuário que Alterou';
COMMENT ON COLUMN ATLAS."AUTOR".SYS_LOCAL_ATUALIZA IS 'Registra local de atualização. | Local de Alteração';
COMMENT ON COLUMN ATLAS."AUTOR".SYS_STATUS IS 'Status do registro entre I=Incluído, A=Alterado ou Vazio=Sem modificação. | Status do Registro';

-- TABELA CLASSE
CREATE TABLE ATLAS."CLASSE" (
   "CODIGO" NUMBER (10,0),
   "NOME_PORT" VARCHAR2 (200),
   "NOME_INGLES" VARCHAR2 (200),
   "NOME_ESPANHOL" VARCHAR2 (200)
,
   SYS_MOMENTO_CRIA DATE,
   SYS_USUARIO_CRIA VARCHAR2 (100),
   SYS_LOCAL_CRIA VARCHAR2 (100),
   SYS_MOMENTO_ATUALIZA DATE,
   SYS_USUARIO_ATUALIZA VARCHAR2 (100),
   SYS_LOCAL_ATUALIZA VARCHAR2 (100),
   SYS_STATUS CHAR (1)
);

ALTER TABLE ATLAS."CLASSE" ADD CONSTRAINT "ID_CLASSE"
PRIMARY KEY("CODIGO");

COMMENT ON TABLE ATLAS."CLASSE" IS 'ATLAS | Classe de fotos. | Classe';

COMMENT ON COLUMN ATLAS."CLASSE"."CODIGO" IS 'Sequencial da classe. | Sequencial';
COMMENT ON COLUMN ATLAS."CLASSE"."NOME_PORT" IS 'Nome da classe. | Nome';
COMMENT ON COLUMN ATLAS."CLASSE"."NOME_INGLES" IS 'Nome da classe em ingês. | Nome';
COMMENT ON COLUMN ATLAS."CLASSE"."NOME_ESPANHOL" IS 'Nome da classe em espanhol. | Nome';
COMMENT ON COLUMN ATLAS."CLASSE".SYS_MOMENTO_CRIA IS 'Registra momento de gravação. | Momento de Criação';
COMMENT ON COLUMN ATLAS."CLASSE".SYS_USUARIO_CRIA IS 'Registra usuário que gravou. | Usuário que Criou';
COMMENT ON COLUMN ATLAS."CLASSE".SYS_LOCAL_CRIA IS 'Registra local de gravação. | Local de Criação';
COMMENT ON COLUMN ATLAS."CLASSE".SYS_MOMENTO_ATUALIZA IS 'Registra momento de atualização. | Momento de Atualização';
COMMENT ON COLUMN ATLAS."CLASSE".SYS_USUARIO_ATUALIZA IS 'Registra usuário que atualizou. | Usuário que Alterou';
COMMENT ON COLUMN ATLAS."CLASSE".SYS_LOCAL_ATUALIZA IS 'Registra local de atualização. | Local de Alteração';
COMMENT ON COLUMN ATLAS."CLASSE".SYS_STATUS IS 'Status do registro entre I=Incluído, A=Alterado ou Vazio=Sem modificação. | Status do Registro';

-- TABELA FOTO
CREATE TABLE ATLAS."FOTO" (
   "COD_CLASSE" NUMBER (10,0),
   "COD_AUTOR" NUMBER (10,0),
   "CODIGO" NUMBER (10,0),
   "LEGENDA_PORT" VARCHAR2 (200),
   "LEGENDA_INGLES" VARCHAR2 (200),
   "LEGENDA_ESPANHOL" VARCHAR2 (200),
   "DESCRICAO_PORT" VARCHAR2 (200),
   "DESCRICAO_INGLES" VARCHAR2 (200),
   "DESCRICAO_ESPANHOL" VARCHAR2 (200),
   "DATA_INCLUSAO" DATE,
   "PUBLICAR" NUMBER (1,0),
   "ARQ_ORIG" VARCHAR2 (200),
   "ORDEM" NUMBER (10,0),
   "OBS" VARCHAR2 (200)
,
   SYS_MOMENTO_CRIA DATE,
   SYS_USUARIO_CRIA VARCHAR2 (100),
   SYS_LOCAL_CRIA VARCHAR2 (100),
   SYS_MOMENTO_ATUALIZA DATE,
   SYS_USUARIO_ATUALIZA VARCHAR2 (100),
   SYS_LOCAL_ATUALIZA VARCHAR2 (100),
   SYS_STATUS CHAR (1)
);

ALTER TABLE ATLAS."FOTO" ADD CONSTRAINT "ID_FOTO"
PRIMARY KEY("CODIGO");

COMMENT ON TABLE ATLAS."FOTO" IS 'ATLAS | Fotos enviadas pelo pesquisador. | Foto';

COMMENT ON COLUMN ATLAS."FOTO"."COD_CLASSE" IS 'Classificação da foto. | Classificação';
COMMENT ON COLUMN ATLAS."FOTO"."COD_AUTOR" IS 'Nome do Autor. | Autor';
COMMENT ON COLUMN ATLAS."FOTO"."CODIGO" IS 'Sequencial da foto. | Sequencial';
COMMENT ON COLUMN ATLAS."FOTO"."LEGENDA_PORT" IS 'Legenda. | Legenda';
COMMENT ON COLUMN ATLAS."FOTO"."LEGENDA_INGLES" IS 'Legenda em inglês. | Legenda';
COMMENT ON COLUMN ATLAS."FOTO"."LEGENDA_ESPANHOL" IS 'Legenda em espanhol. | Legenda';
COMMENT ON COLUMN ATLAS."FOTO"."DESCRICAO_PORT" IS 'Descrição. | Descrição';
COMMENT ON COLUMN ATLAS."FOTO"."DESCRICAO_INGLES" IS 'Descrição em inglês. | Descrição';
COMMENT ON COLUMN ATLAS."FOTO"."DESCRICAO_ESPANHOL" IS 'Descrição em espanhol. | Descrição';
COMMENT ON COLUMN ATLAS."FOTO"."DATA_INCLUSAO" IS 'Data de cadastro. | Data de Inclusão';
COMMENT ON COLUMN ATLAS."FOTO"."PUBLICAR" IS 'Publicar foto. | Publicar';
COMMENT ON COLUMN ATLAS."FOTO"."ARQ_ORIG" IS 'Arquivo original. | Nome do Arquivo Original';
COMMENT ON COLUMN ATLAS."FOTO"."ORDEM" IS 'Ordenação. | Ordenação';
COMMENT ON COLUMN ATLAS."FOTO"."OBS" IS 'Observação da foto. | Observação';
COMMENT ON COLUMN ATLAS."FOTO".SYS_MOMENTO_CRIA IS 'Registra momento de gravação. | Momento de Criação';
COMMENT ON COLUMN ATLAS."FOTO".SYS_USUARIO_CRIA IS 'Registra usuário que gravou. | Usuário que Criou';
COMMENT ON COLUMN ATLAS."FOTO".SYS_LOCAL_CRIA IS 'Registra local de gravação. | Local de Criação';
COMMENT ON COLUMN ATLAS."FOTO".SYS_MOMENTO_ATUALIZA IS 'Registra momento de atualização. | Momento de Atualização';
COMMENT ON COLUMN ATLAS."FOTO".SYS_USUARIO_ATUALIZA IS 'Registra usuário que atualizou. | Usuário que Alterou';
COMMENT ON COLUMN ATLAS."FOTO".SYS_LOCAL_ATUALIZA IS 'Registra local de atualização. | Local de Alteração';
COMMENT ON COLUMN ATLAS."FOTO".SYS_STATUS IS 'Status do registro entre I=Incluído, A=Alterado ou Vazio=Sem modificação. | Status do Registro';

-- TABELA SYS_CONFIG_GLOBAL
CREATE TABLE ATLAS."SYS_CONFIG_GLOBAL" (
   "PARAM" VARCHAR2 (200),
   "DESCR" VARCHAR2 (4000),
   "CONFIG" CLOB,
   "PROP_EXTEND" CLOB,
   "FORMATO" VARCHAR2 (100)
,
   SYS_MOMENTO_CRIA DATE,
   SYS_USUARIO_CRIA VARCHAR2 (100),
   SYS_LOCAL_CRIA VARCHAR2 (100),
   SYS_MOMENTO_ATUALIZA DATE,
   SYS_USUARIO_ATUALIZA VARCHAR2 (100),
   SYS_LOCAL_ATUALIZA VARCHAR2 (100),
   SYS_STATUS CHAR (1)
);

ALTER TABLE ATLAS."SYS_CONFIG_GLOBAL" ADD CONSTRAINT "ID_SYS_CONFIG_GLOBAL"
PRIMARY KEY("PARAM");

COMMENT ON TABLE ATLAS."SYS_CONFIG_GLOBAL" IS 'Sistema | Armazena parâmetros globais do aplicativo. | Configuração Global';

COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL"."PARAM" IS 'Parametro. | Parâmetro';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL"."DESCR" IS 'Descrição. | Descrição';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL"."CONFIG" IS 'Configuração. | Configuração';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL"."PROP_EXTEND" IS 'Propriedades extendidas para configuração. | Propriedades';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL"."FORMATO" IS 'Formato de apresentação do campo MEMO, HTML ou vazio para texto comum. | Formato';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL".SYS_MOMENTO_CRIA IS 'Registra momento de gravação. | Momento de Criação';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL".SYS_USUARIO_CRIA IS 'Registra usuário que gravou. | Usuário que Criou';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL".SYS_LOCAL_CRIA IS 'Registra local de gravação. | Local de Criação';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL".SYS_MOMENTO_ATUALIZA IS 'Registra momento de atualização. | Momento de Atualização';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL".SYS_USUARIO_ATUALIZA IS 'Registra usuário que atualizou. | Usuário que Alterou';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL".SYS_LOCAL_ATUALIZA IS 'Registra local de atualização. | Local de Alteração';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_GLOBAL".SYS_STATUS IS 'Status do registro entre I=Incluído, A=Alterado ou Vazio=Sem modificação. | Status do Registro';

-- TABELA SYS_CONFIG_USUARIO
CREATE TABLE ATLAS."SYS_CONFIG_USUARIO" (
   "USUARIO" VARCHAR2 (100),
   "PARAM" VARCHAR2 (200),
   "DESCR" VARCHAR2 (4000),
   "CONFIG" VARCHAR2 (4000)
,
   SYS_MOMENTO_CRIA DATE,
   SYS_USUARIO_CRIA VARCHAR2 (100),
   SYS_LOCAL_CRIA VARCHAR2 (100),
   SYS_MOMENTO_ATUALIZA DATE,
   SYS_USUARIO_ATUALIZA VARCHAR2 (100),
   SYS_LOCAL_ATUALIZA VARCHAR2 (100),
   SYS_STATUS CHAR (1)
);

ALTER TABLE ATLAS."SYS_CONFIG_USUARIO" ADD CONSTRAINT "ID_SYS_CONFIG_USUARIO"
PRIMARY KEY("USUARIO", "PARAM");

COMMENT ON TABLE ATLAS."SYS_CONFIG_USUARIO" IS 'Sistema | Parâmetros específicos de usuários do sistema. | Configuração de Usuário';

COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO"."USUARIO" IS 'Usuário. | Usuário';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO"."PARAM" IS 'Parametro. | Parâmetro';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO"."DESCR" IS 'Descrição. | Descrição';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO"."CONFIG" IS 'Configuração. | Configuração';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO".SYS_MOMENTO_CRIA IS 'Registra momento de gravação. | Momento de Criação';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO".SYS_USUARIO_CRIA IS 'Registra usuário que gravou. | Usuário que Criou';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO".SYS_LOCAL_CRIA IS 'Registra local de gravação. | Local de Criação';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO".SYS_MOMENTO_ATUALIZA IS 'Registra momento de atualização. | Momento de Atualização';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO".SYS_USUARIO_ATUALIZA IS 'Registra usuário que atualizou. | Usuário que Alterou';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO".SYS_LOCAL_ATUALIZA IS 'Registra local de atualização. | Local de Alteração';
COMMENT ON COLUMN ATLAS."SYS_CONFIG_USUARIO".SYS_STATUS IS 'Status do registro entre I=Incluído, A=Alterado ou Vazio=Sem modificação. | Status do Registro';

-- TABELA SYS_DELETE
CREATE TABLE ATLAS."SYS_DELETE" (
   "TABELA" VARCHAR2 (70),
   "CHAVE" VARCHAR2 (300),
   "MOMENTO" DATE,
   "USUARIO" VARCHAR2 (100),
   "LOCAL" VARCHAR2 (20)
);

ALTER TABLE ATLAS."SYS_DELETE" ADD CONSTRAINT "ID_SYS_DELETE"
PRIMARY KEY("TABELA", "CHAVE");

COMMENT ON TABLE ATLAS."SYS_DELETE" IS 'Sistema | Registro de exclusões do sistema. | Registro de Exclusões';

COMMENT ON COLUMN ATLAS."SYS_DELETE"."TABELA" IS 'Nome da tabela onde a exclusão ocorreu. | Tabela';
COMMENT ON COLUMN ATLAS."SYS_DELETE"."CHAVE" IS 'Conteúdo da chave do registro excluído. | Chave';
COMMENT ON COLUMN ATLAS."SYS_DELETE"."MOMENTO" IS 'Momento em que ocorreu a exclusão. | Momento de Exclusão';
COMMENT ON COLUMN ATLAS."SYS_DELETE"."USUARIO" IS 'Detalhes do usuário que efetuou a exclusão. | Usuário';
COMMENT ON COLUMN ATLAS."SYS_DELETE"."LOCAL" IS 'De onde partiu a exclusão. | Local';

-- TABELA SYS_LOCALID
CREATE TABLE ATLAS."SYS_LOCALID" (
   "NOME" VARCHAR2 (20),
   "CORRENTE" NUMBER (1,0),
   "PACOTE" NUMBER (11,0),
   "PACOTE_REC" NUMBER (11,0),
   "MOMENTO" DATE,
   "MOMENTO_REC" DATE,
   "MODELO" NUMBER (11,0),
   "DESCR" VARCHAR2 (50),
   "OBS" VARCHAR2 (4000)
,
   SYS_MOMENTO_CRIA DATE,
   SYS_USUARIO_CRIA VARCHAR2 (100),
   SYS_LOCAL_CRIA VARCHAR2 (100),
   SYS_MOMENTO_ATUALIZA DATE,
   SYS_USUARIO_ATUALIZA VARCHAR2 (100),
   SYS_LOCAL_ATUALIZA VARCHAR2 (100),
   SYS_STATUS CHAR (1)
);

ALTER TABLE ATLAS."SYS_LOCALID" ADD CONSTRAINT "ID_SYS_LOCALID"
PRIMARY KEY("NOME");

COMMENT ON TABLE ATLAS."SYS_LOCALID" IS 'Sistema | Especificações de localidade para sistema distribuído. | Detalhes de Localidade';

COMMENT ON COLUMN ATLAS."SYS_LOCALID"."NOME" IS 'Nome em caso de sistema distribuído. | Nome';
COMMENT ON COLUMN ATLAS."SYS_LOCALID"."CORRENTE" IS 'Marcado caso seja localidade corrente. | Corrente';
COMMENT ON COLUMN ATLAS."SYS_LOCALID"."PACOTE" IS 'Número do último pacote gerado. | Pacote Gerado';
COMMENT ON COLUMN ATLAS."SYS_LOCALID"."PACOTE_REC" IS 'Número do último pacote recebido. | Pacote Recebido';
COMMENT ON COLUMN ATLAS."SYS_LOCALID"."MOMENTO" IS 'Momento do último pacote gerado. | Momento de Geração';
COMMENT ON COLUMN ATLAS."SYS_LOCALID"."MOMENTO_REC" IS 'Momento do último pacote recebido. | Momento de Recebimento';
COMMENT ON COLUMN ATLAS."SYS_LOCALID"."MODELO" IS 'Modelo. | Modelo';
COMMENT ON COLUMN ATLAS."SYS_LOCALID"."DESCR" IS 'Descrição de localidade, responsabilidade ou qualquer texto que informe sobre a localidade. | Descrição';
COMMENT ON COLUMN ATLAS."SYS_LOCALID"."OBS" IS 'Observações sobre a localidade. | Observações';
COMMENT ON COLUMN ATLAS."SYS_LOCALID".SYS_MOMENTO_CRIA IS 'Registra momento de gravação. | Momento de Criação';
COMMENT ON COLUMN ATLAS."SYS_LOCALID".SYS_USUARIO_CRIA IS 'Registra usuário que gravou. | Usuário que Criou';
COMMENT ON COLUMN ATLAS."SYS_LOCALID".SYS_LOCAL_CRIA IS 'Registra local de gravação. | Local de Criação';
COMMENT ON COLUMN ATLAS."SYS_LOCALID".SYS_MOMENTO_ATUALIZA IS 'Registra momento de atualização. | Momento de Atualização';
COMMENT ON COLUMN ATLAS."SYS_LOCALID".SYS_USUARIO_ATUALIZA IS 'Registra usuário que atualizou. | Usuário que Alterou';
COMMENT ON COLUMN ATLAS."SYS_LOCALID".SYS_LOCAL_ATUALIZA IS 'Registra local de atualização. | Local de Alteração';
COMMENT ON COLUMN ATLAS."SYS_LOCALID".SYS_STATUS IS 'Status do registro entre I=Incluído, A=Alterado ou Vazio=Sem modificação. | Status do Registro';

-- TABELA SYS_OCORRENCIA
CREATE TABLE ATLAS."SYS_OCORRENCIA" (
   "SEQ" NUMBER (11,0),
   "APLICACAO" VARCHAR2 (4000),
   "OCORRENCIA" VARCHAR2 (4000),
   "USUARIO" VARCHAR2 (100),
   "MOMENTO" DATE,
   "LOCAL" VARCHAR2 (20)
,
   SYS_MOMENTO_CRIA DATE,
   SYS_USUARIO_CRIA VARCHAR2 (100),
   SYS_LOCAL_CRIA VARCHAR2 (100),
   SYS_MOMENTO_ATUALIZA DATE,
   SYS_USUARIO_ATUALIZA VARCHAR2 (100),
   SYS_LOCAL_ATUALIZA VARCHAR2 (100),
   SYS_STATUS CHAR (1)
);

ALTER TABLE ATLAS."SYS_OCORRENCIA" ADD CONSTRAINT "ID_SYS_OCORRENCIA"
PRIMARY KEY("SEQ");

COMMENT ON TABLE ATLAS."SYS_OCORRENCIA" IS 'Sistema | Registro de ocorrências do sistema. | Registro de Ocorrências';

COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA"."SEQ" IS 'Sequencial da ocorrência. | Sequencial';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA"."APLICACAO" IS 'Nome do aplicativo onde ocorreu o registro. | Aplicação';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA"."OCORRENCIA" IS 'Detalhes da ocorrência. | Ocorrência';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA"."USUARIO" IS 'Usuário logado no momento da ocorrência. | Usuário';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA"."MOMENTO" IS 'Momento em que ocorreu a situação. | Momento';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA"."LOCAL" IS 'Local onde ocorreu o registro. | Localidade';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA".SYS_MOMENTO_CRIA IS 'Registra momento de gravação. | Momento de Criação';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA".SYS_USUARIO_CRIA IS 'Registra usuário que gravou. | Usuário que Criou';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA".SYS_LOCAL_CRIA IS 'Registra local de gravação. | Local de Criação';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA".SYS_MOMENTO_ATUALIZA IS 'Registra momento de atualização. | Momento de Atualização';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA".SYS_USUARIO_ATUALIZA IS 'Registra usuário que atualizou. | Usuário que Alterou';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA".SYS_LOCAL_ATUALIZA IS 'Registra local de atualização. | Local de Alteração';
COMMENT ON COLUMN ATLAS."SYS_OCORRENCIA".SYS_STATUS IS 'Status do registro entre I=Incluído, A=Alterado ou Vazio=Sem modificação. | Status do Registro';

-- TABELA TECNICO
CREATE TABLE ATLAS."TECNICO" (
   "SEQ" NUMBER (10,0),
   "TECNICO" VARCHAR2 (200),
   "INTERNET_CHAVE" VARCHAR2 (200)
,
   SYS_MOMENTO_CRIA DATE,
   SYS_USUARIO_CRIA VARCHAR2 (100),
   SYS_LOCAL_CRIA VARCHAR2 (100),
   SYS_MOMENTO_ATUALIZA DATE,
   SYS_USUARIO_ATUALIZA VARCHAR2 (100),
   SYS_LOCAL_ATUALIZA VARCHAR2 (100),
   SYS_STATUS CHAR (1)
);

ALTER TABLE ATLAS."TECNICO" ADD CONSTRAINT "ID_TECNICO"
PRIMARY KEY("SEQ");

COMMENT ON TABLE ATLAS."TECNICO" IS 'ATLAS | Técnico que efetua manutenção. | Técnico';

COMMENT ON COLUMN ATLAS."TECNICO"."SEQ" IS 'Sequencial do técnico. | Sequencial';
COMMENT ON COLUMN ATLAS."TECNICO"."TECNICO" IS 'Nome do técnico. | Nome do Técnico';
COMMENT ON COLUMN ATLAS."TECNICO"."INTERNET_CHAVE" IS 'Chave na internet. | Chave na Internet';
COMMENT ON COLUMN ATLAS."TECNICO".SYS_MOMENTO_CRIA IS 'Registra momento de gravação. | Momento de Criação';
COMMENT ON COLUMN ATLAS."TECNICO".SYS_USUARIO_CRIA IS 'Registra usuário que gravou. | Usuário que Criou';
COMMENT ON COLUMN ATLAS."TECNICO".SYS_LOCAL_CRIA IS 'Registra local de gravação. | Local de Criação';
COMMENT ON COLUMN ATLAS."TECNICO".SYS_MOMENTO_ATUALIZA IS 'Registra momento de atualização. | Momento de Atualização';
COMMENT ON COLUMN ATLAS."TECNICO".SYS_USUARIO_ATUALIZA IS 'Registra usuário que atualizou. | Usuário que Alterou';
COMMENT ON COLUMN ATLAS."TECNICO".SYS_LOCAL_ATUALIZA IS 'Registra local de atualização. | Local de Alteração';
COMMENT ON COLUMN ATLAS."TECNICO".SYS_STATUS IS 'Status do registro entre I=Incluído, A=Alterado ou Vazio=Sem modificação. | Status do Registro';

-- TABELA TECNICO_ACESSO
CREATE TABLE ATLAS."TECNICO_ACESSO" (
   "SEQ" NUMBER (10,0),
   "TECNICO" VARCHAR2 (200),
   "MOMENTO" DATE,
   "IP" VARCHAR2 (200),
   "MEIO" VARCHAR2 (200)
,
   SYS_MOMENTO_CRIA DATE,
   SYS_USUARIO_CRIA VARCHAR2 (100),
   SYS_LOCAL_CRIA VARCHAR2 (100),
   SYS_MOMENTO_ATUALIZA DATE,
   SYS_USUARIO_ATUALIZA VARCHAR2 (100),
   SYS_LOCAL_ATUALIZA VARCHAR2 (100),
   SYS_STATUS CHAR (1)
);

ALTER TABLE ATLAS."TECNICO_ACESSO" ADD CONSTRAINT "ID_TECNICO_ACESSO"
PRIMARY KEY("SEQ");

COMMENT ON TABLE ATLAS."TECNICO_ACESSO" IS 'ATLAS | Registro de acesso do técnico. | Acesso do Técnico';

COMMENT ON COLUMN ATLAS."TECNICO_ACESSO"."SEQ" IS 'Sequencial. | Sequencial';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO"."TECNICO" IS 'Técnico. | Técnico';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO"."MOMENTO" IS 'Data de cadastro. | Data de Cadastro';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO"."IP" IS 'Número do IP. | IP';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO"."MEIO" IS 'Meio. | Meio';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO".SYS_MOMENTO_CRIA IS 'Registra momento de gravação. | Momento de Criação';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO".SYS_USUARIO_CRIA IS 'Registra usuário que gravou. | Usuário que Criou';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO".SYS_LOCAL_CRIA IS 'Registra local de gravação. | Local de Criação';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO".SYS_MOMENTO_ATUALIZA IS 'Registra momento de atualização. | Momento de Atualização';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO".SYS_USUARIO_ATUALIZA IS 'Registra usuário que atualizou. | Usuário que Alterou';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO".SYS_LOCAL_ATUALIZA IS 'Registra local de atualização. | Local de Alteração';
COMMENT ON COLUMN ATLAS."TECNICO_ACESSO".SYS_STATUS IS 'Status do registro entre I=Incluído, A=Alterado ou Vazio=Sem modificação. | Status do Registro';

/* **********************************************************************************
   CRIAÇÃO DE TABELAS DO SISTEMA
*/


-- TABELA DE SISTEMA - GRANTS GERAIS
GRANT SELECT ON ATLAS.SYS_CONFIG_GLOBAL TO PUBLIC;
GRANT SELECT ON ATLAS.SYS_CONFIG_USUARIO TO PUBLIC;
GRANT SELECT ON ATLAS.SYS_DELETE TO PUBLIC;
GRANT SELECT ON ATLAS.SYS_LOCALID TO PUBLIC;
GRANT SELECT ON ATLAS.SYS_OCORRENCIA TO PUBLIC;
SPOOL OFF


-- EXEMPLO PARA IMPORT DE INFORMAÇÕES E 
-- CÓDIGO PARA ELIMINAR OBJETOS IMPORTADOS EQUIVOCADAMENTE

SET SERVEROUTPUT ON SIZE 40000
SET ECHO OFF
SELECT
'EXP ATLAS/XXXX@SBDB OWNER=(ATLAS) FILE=ATLAS.DMP LOG=ATLAS_EXP.LOG' || CHR(13) || CHR(10) ||
'IMP ATLAS/XXXX@SBDB FROMUSER=ATLAS CONSTRAINTS=NO GRANTS=NO FILE=ATLAS.DMP LOG=ATLAS_IMP.LOG IGNORE=YES' || CHR(13) || CHR(10) ||
'' || CHR(13) || CHR(10) ||
'' || CHR(13) || CHR(10) ||
'DECLARE' || CHR(13) || CHR(10) ||
'    MAX NUMBER := ' || MAX(OBJECT_ID) || ';' || CHR(13) || CHR(10) ||
'BEGIN' || CHR(13) || CHR(10) ||
' FOR CUR IN (SELECT ''DROP '' || OBJECT_TYPE || '' '' || OWNER || ''.'' || OBJECT_NAME ' || CHR(13) || CHR(10) ||
' AS COL FROM ALL_OBJECTS WHERE OBJECT_ID > MAX) LOOP' || CHR(13) || CHR(10) ||
'  DBMS_OUTPUT.PUT(CUR.COL);' || CHR(13) || CHR(10) ||
'  BEGIN' || CHR(13) || CHR(10) ||
'   EXECUTE IMMEDIATE CUR.COL;' || CHR(13) || CHR(10) ||
'   DBMS_OUTPUT.PUT_LINE('' ==> OK'');' || CHR(13) || CHR(10) ||
'  EXCEPTION WHEN OTHERS THEN' || CHR(13) || CHR(10) ||
'   DBMS_OUTPUT.PUT_LINE('' ==> '' || SQLERRM);' || CHR(13) || CHR(10) ||
'  END;' || CHR(13) || CHR(10) ||
' END LOOP;' || CHR(13) || CHR(10) ||
'END;' || CHR(13) || CHR(10) ||
'/' || CHR(13) || CHR(10) ||
'' || CHR(13) || CHR(10) ||
'' || CHR(13) || CHR(10) FROM ALL_OBJECTS
/



SPOOL OFF
$ECHO - >>"C:\ATLAS_PARTES.LOG"
$ECHO - >>"C:\ATLAS_PARTES.LOG"
$ECHO - >>"C:\ATLAS_PARTES.LOG"
$COMMAND /C ECHO %DATE% %TIME% >>"C:\ATLAS_PARTES.LOG"
$COMMAND /C FIND "ORA-" "C:\ATLAS_PARTE1.LOG" >>"C:\ATLAS_PARTES.LOG"
$COMMAND /C FIND "SP2-" "C:\ATLAS_PARTE1.LOG" >>"C:\ATLAS_PARTES.LOG"
