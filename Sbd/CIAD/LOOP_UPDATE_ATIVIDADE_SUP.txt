DECLARE
CURSOR CURATIV IS 
	SELECT EMCD_ATIVIDADE.COD, EMCD_ATIV_NÓ.INFERIOR AS INF, EMCD_ATIV_NÓ.SUPERIOR AS SUP
FROM EMCD_ATIVIDADE,EMCD_ATIV_NÓ WHERE EMCD_ATIV_NÓ.INFERIOR(+) = EMCD_ATIVIDADE.COD
ORDER BY EMCD_ATIVIDADE.COD, EMCD_ATIV_NÓ.INFERIOR;

BEGIN
	FOR CUR IN CURATIV LOOP
		IF CUR.COD = 1 THEN
			UPDATE EMCD_ATIVIDADE SET SUPERIOR = NULL WHERE COD = CUR.COD;
		ELSE
			UPDATE EMCD_ATIVIDADE SET SUPERIOR = CUR.SUP WHERE COD = CUR.COD;		
		END IF;
	END LOOP;
COMMIT;
END;
/