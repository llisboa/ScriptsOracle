UPDATE EMCD_ATIVIDADE SET NÍVEL_NÓ = NULL, POSIÇÃO_NÓ = NULL;

UPDATE EMCD_ATIVIDADE SET NÍVEL_NÓ = 0,
POSIÇÃO_NÓ = TO_CHAR(ROWNUM,'FM0000')
WHERE SUPERIOR IS NULL;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 1,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 0);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 1
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 1;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 2,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 1);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 2
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 2;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 3,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 2);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 3
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 3;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 4,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 3);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 4
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 4;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 5,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 4);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 5
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 5;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 6,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 5);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 6
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 6;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 7,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 6);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 7
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 7;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 8,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 7);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 8
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 8;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 9,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 8);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 9
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 9;


UPDATE EMCD_ATIVIDADE FILHO SET NÍVEL_NÓ = 10,
POSIÇÃO_NÓ = (SELECT POSIÇÃO_NÓ FROM EMCD_ATIVIDADE WHERE COD = FILHO.SUPERIOR)
WHERE SUPERIOR IN (SELECT COD FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 9);

UPDATE EMCD_ATIVIDADE FILHO SET POSIÇÃO_NÓ = (SELECT POS FROM
(SELECT COD, POSIÇÃO_NÓ || 
TO_CHAR(ROW_NUMBER() OVER (PARTITION BY POSIÇÃO_NÓ ORDER BY ORDEM),'0000')
POS FROM EMCD_ATIVIDADE WHERE NÍVEL_NÓ = 10
) WHERE FILHO.COD = COD)
WHERE NÍVEL_NÓ = 10;























