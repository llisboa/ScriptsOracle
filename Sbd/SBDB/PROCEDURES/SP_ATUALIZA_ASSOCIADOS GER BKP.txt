CREATE OR REPLACE PROCEDURE sp_atualiza_associados
  (
    P_MATRICULA IN NUMBER,
    P_NOME IN VARCHAR2,
    P_CATEGORIA IN VARCHAR2,
    P_OBRIG_STATUS_COD IN VARCHAR2,
    P_REGIONAL IN VARCHAR2,
    P_CRM IN VARCHAR2,
    P_CRM_ESTADO IN VARCHAR2,
    P_CRM_DATA IN VARCHAR2,
    P_CPF IN VARCHAR2,
    P_IDENTIDADE IN VARCHAR2,
    P_ID_ORGAO IN VARCHAR2,
    P_DATA_NASCIMENTO IN VARCHAR2,
    P_SEXO IN VARCHAR2,
    P_NACIONALIDADE IN VARCHAR2,
    P_NATURALIDADE IN VARCHAR2,
    P_ENDEREÇO_RESIDENCIAL IN VARCHAR2,
    P_BAIRRO_RESIDENCIAL IN VARCHAR2,
    P_CIDADE_RESIDENCIAL IN VARCHAR2,
    P_PAIS_RESIDENCIAL IN VARCHAR2,
    P_CEP_RESIDENCIAL IN VARCHAR2,
    P_DDI_RESIDENCIAL IN VARCHAR2,
    P_DDD_RESIDENCIAL IN VARCHAR2,
    P_TEL_RESIDENCIAL IN VARCHAR2,
    P_FAX_RESIDENCIAL IN VARCHAR2,
    P_TEL_CELULAR_RESIDENCIAL IN VARCHAR2,
    P_EMAIL_RESIDENCIAL IN VARCHAR2,
    P_ENDEREÇO_COMERCIAL_1 IN VARCHAR2,
    P_BAIRRO_COMERCIAL_1 IN VARCHAR2,
    P_ESTADO_COMERCIAL_1 IN VARCHAR2,
    P_CIDADE_COMERCIAL_1 IN VARCHAR2,
    P_PAIS_COMERCIAL_1 IN VARCHAR2,
    P_CEP_COMERCIAL_1 IN VARCHAR2,
    P_DDI_COMERCIAL_1 IN VARCHAR2,
    P_DDD_COMERCIAL_1 IN VARCHAR2,
    P_TEL_COMERCIAL_1 IN VARCHAR2,
    P_FAX_COMERCIAL_1 IN VARCHAR2,
    P_EMAIL_COMERCIAL_1 IN VARCHAR2,
    P_SENHA IN VARCHAR2,
    P_MALA_DIRETA IN VARCHAR2,
    P_ESTADO_RESIDENCIAL IN VARCHAR2,
    P_DATA_CNA IN VARCHAR2,
    P_ESTADO_RESIDENCIAL_EX IN VARCHAR2,
    P_ESTADO_COMERCIAL_1_EX IN VARCHAR2,
    P_STATUS_STR OUT VARCHAR2)
AS
  V_SENHA VARCHAR2(20) ;
  V_MAT   NUMBER(5) ;
BEGIN
  P_STATUS_STR := 'Associado atualizado com sucesso.';
  IF P_SENHA = '' THEN
    V_SENHA := '12345';
  ELSE
    V_SENHA := P_SENHA;
  END IF;
  SELECT NVL(COUNT(MAT), 0) INTO V_MAT FROM SBDB.SÓCIO WHERE MAT = P_MATRICULA;
  IF V_MAT = 0 THEN
    P_STATUS_STR := 'Associado cadastrado com sucesso.';
    INSERT
      INTO
        SBDB.SÓCIO
        (
          MAT, NOME_PREFERENCIAL, CATEGORIA_COD, OBRIG_STATUS_COD, REGIONAL_COD, CRM, CRM_ESTADO, CRM_DATA, CPF, IDENTIDADE, ID_ORGAO, DATA_NASCIMENTO, SEXO, NACIONALIDADE, NATURALIDADE, CFM_ADESAO, ENDEREÇO_RESIDENCIAL, BAIRRO_RESIDENCIAL, CIDADE_RESIDENCIAL, PAÍS_RESIDENCIAL, CEP_RESIDENCIAL, DDI_RESIDENCIAL, DDD_RESIDENCIAL, TEL_RESIDENCIAL, FAX_RESIDENCIAL, TEL_CELULAR_RESIDENCIAL, EMAIL_RESIDENCIAL, ENDEREÇO_COMERCIAL_1, BAIRRO_COMERCIAL_1, ESTADO_COMERCIAL_1, CIDADE_COMERCIAL_1, PAÍS_COMERCIAL_1, CEP_COMERCIAL_1, DDI_COMERCIAL_1, DDD_COMERCIAL_1, TEL_COMERCIAL_1, FAX_COMERCIAL_1, EMAIL_COMERCIAL_1, SENHA, MALA_DIRETA, ESTADO_RESIDENCIAL, ESTADO_RESIDENCIAL_EX, ESTADO_COMERCIAL_1_EX
        )
        VALUES
        (
          P_MATRICULA, P_NOME, P_CATEGORIA, P_OBRIG_STATUS_COD, P_REGIONAL, P_CRM, P_CRM_ESTADO, TO_DATE(P_CRM_DATA, 'DD/MM/YYYY'), P_CPF, P_IDENTIDADE, P_ID_ORGAO, TO_DATE(P_DATA_NASCIMENTO, 'DD/MM/YYYY'), P_SEXO, P_NACIONALIDADE, P_NATURALIDADE, P_DATA_CNA, P_ENDEREÇO_RESIDENCIAL, P_BAIRRO_RESIDENCIAL, P_CIDADE_RESIDENCIAL, P_PAIS_RESIDENCIAL, P_CEP_RESIDENCIAL, P_DDI_RESIDENCIAL, P_DDD_RESIDENCIAL, P_TEL_RESIDENCIAL, P_FAX_RESIDENCIAL, P_TEL_CELULAR_RESIDENCIAL, P_EMAIL_RESIDENCIAL, P_ENDEREÇO_COMERCIAL_1, P_BAIRRO_COMERCIAL_1, P_ESTADO_COMERCIAL_1, P_CIDADE_COMERCIAL_1, P_PAIS_COMERCIAL_1, P_CEP_COMERCIAL_1, P_DDI_COMERCIAL_1, P_DDD_COMERCIAL_1, P_TEL_COMERCIAL_1, P_FAX_COMERCIAL_1, P_EMAIL_COMERCIAL_1, V_SENHA, P_MALA_DIRETA, P_ESTADO_RESIDENCIAL,P_ESTADO_RESIDENCIAL_EX,P_ESTADO_COMERCIAL_1_EX
        ) ;
  ELSE
    UPDATE
        SBDB.SÓCIO
      SET
        SBDB.SÓCIO.NOME_PREFERENCIAL = P_NOME, CATEGORIA_COD = P_CATEGORIA, OBRIG_STATUS_COD = P_OBRIG_STATUS_COD, REGIONAL_COD = P_REGIONAL, CRM = P_CRM, CRM_ESTADO = P_CRM_ESTADO, CRM_DATA = TO_DATE(P_CRM_DATA, 'DD/MM/YYYY'), CPF = P_CPF, IDENTIDADE = P_IDENTIDADE, ID_ORGAO = P_ID_ORGAO, DATA_NASCIMENTO = TO_DATE(P_DATA_NASCIMENTO, 'DD/MM/YYYY'), SEXO = P_SEXO, NACIONALIDADE = P_NACIONALIDADE, NATURALIDADE = P_NATURALIDADE, CFM_ADESAO = P_DATA_CNA, ENDEREÇO_RESIDENCIAL = P_ENDEREÇO_RESIDENCIAL, BAIRRO_RESIDENCIAL = P_BAIRRO_RESIDENCIAL, CIDADE_RESIDENCIAL = P_CIDADE_RESIDENCIAL, PAÍS_RESIDENCIAL = P_PAIS_RESIDENCIAL, CEP_RESIDENCIAL = P_CEP_RESIDENCIAL, DDI_RESIDENCIAL = P_DDI_RESIDENCIAL, DDD_RESIDENCIAL = P_DDD_RESIDENCIAL, TEL_RESIDENCIAL = P_TEL_RESIDENCIAL, FAX_RESIDENCIAL = P_FAX_RESIDENCIAL, TEL_CELULAR_RESIDENCIAL = P_TEL_CELULAR_RESIDENCIAL, EMAIL_RESIDENCIAL = P_EMAIL_RESIDENCIAL, ENDEREÇO_COMERCIAL_1 = P_ENDEREÇO_COMERCIAL_1, BAIRRO_COMERCIAL_1 = P_BAIRRO_COMERCIAL_1, ESTADO_COMERCIAL_1 = P_ESTADO_COMERCIAL_1, CIDADE_COMERCIAL_1 = P_CIDADE_COMERCIAL_1, PAÍS_COMERCIAL_1 = P_PAIS_COMERCIAL_1, CEP_COMERCIAL_1 = P_CEP_COMERCIAL_1, DDI_COMERCIAL_1 = P_DDI_COMERCIAL_1, DDD_COMERCIAL_1 = P_DDD_COMERCIAL_1, TEL_COMERCIAL_1 = P_TEL_COMERCIAL_1, FAX_COMERCIAL_1 = P_FAX_COMERCIAL_1, EMAIL_COMERCIAL_1 = P_EMAIL_COMERCIAL_1, MALA_DIRETA = P_MALA_DIRETA, ESTADO_RESIDENCIAL = P_ESTADO_RESIDENCIAL, ESTADO_RESIDENCIAL_EX = P_ESTADO_RESIDENCIAL_EX, ESTADO_COMERCIAL_1_EX = P_ESTADO_COMERCIAL_1_EX, SYS_STATUS = 'X', SYS_USUARIO_ATUALIZA = P_CRM_ESTADO||P_CRM, SYS_MOMENTO_ATUALIZA = SYSDATE
      WHERE
        MAT = P_MATRICULA;
  END IF;
EXCEPTION
WHEN OTHERS THEN
  RAISE_APPLICATION_ERROR( - 20000, 'Erro ao atualizar cadastro - ' || SQLERRM) ;
END;
/