CREATE OR REPLACE TRIGGER aft_socio_publ_end AFTER UPDATE OF PUBLICAR_COMERCIAL_1,PUBLICAR_COMERCIAL_2 ON "SÓCIO"
FOR EACH ROW
DECLARE
  vPub_1 Integer;
  vPub_2 Integer;
  vSeqHistPubEnd Integer;
BEGIN
  IF :OLD.PUBLICAR_COMERCIAL_1 <> :NEW.PUBLICAR_COMERCIAL_1 THEN
    vPub_1 := :NEW.PUBLICAR_COMERCIAL_1;
  else
    vPub_1 := :OLD.PUBLICAR_COMERCIAL_1;
  END IF;
  IF :OLD.PUBLICAR_COMERCIAL_2 <> :NEW.PUBLICAR_COMERCIAL_2 THEN
    vPub_2 := :NEW.PUBLICAR_COMERCIAL_2;
  else
    vPub_2 := :OLD.PUBLICAR_COMERCIAL_2;
  END IF;
  IF (:OLD.PUBLICAR_COMERCIAL_1 <> :NEW.PUBLICAR_COMERCIAL_1) OR (:OLD.PUBLICAR_COMERCIAL_2 <> :NEW.PUBLICAR_COMERCIAL_2) THEN
    SELECT MAX(NVL(SEQ,0)) + 1 into vSeqHistPubEnd FROM SBDB.HISTORICO_SOCIO_PUBL_END;
    INSERT INTO HISTORICO_SOCIO_PUBL_END (SEQ,SOCIO_MAT, PUBLICAR_COM_1,PUBLICAR_COM_2) VALUES (vSeqHistPubEnd,:OLD.MAT, vPub_1, vPub_2);
  END IF;
END;