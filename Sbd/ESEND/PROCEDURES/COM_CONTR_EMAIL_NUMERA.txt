CREATE OR REPLACE
PROCEDURE COM_CONTR_EMAIL_NUMERA
  (
    COM   NUMBER,
    CONTR NUMBER)
             IS
  SEQ NUMBER := 1;
BEGIN
  FOR CUR IN
  (SELECT COMUNICADO_SEQ,
    CONTROLE_SEQ        ,
    EMAIL
     FROM ESEND.COMUNICADO_CONTR_EMAIL
    WHERE COMUNICADO_SEQ = COM
  AND CONTROLE_SEQ       = CONTR
 ORDER BY DOMINIO,
    EMAIL
  )
  LOOP
     UPDATE ESEND.COMUNICADO_CONTR_EMAIL
    SET ORDEM              = SEQ
      WHERE COMUNICADO_SEQ = CUR.COMUNICADO_SEQ
    AND CONTROLE_SEQ       = CUR.CONTROLE_SEQ
    AND EMAIL              = CUR.EMAIL;
    
    SEQ := SEQ + 1;
  END LOOP;
  COMMIT;
END;